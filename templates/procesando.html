{% extends 'base.html' %}

{% block content %}

<h3>Generando reporte, por favor espera...</h3>
<p>Esto puede tardar unos segundos.</p>
<p>Una vez que el reporte esté listo, se descargará automáticamente.</p>
<a href="{{ url_for('home') }}" class="btn btn-secondary">Volver al Inicio</a>

<script>
    const filename = "{{ filename }}";

    function checkIfReady() {
        fetch(`/reporte_disponible/${filename}`)
            .then(res => {
                if (res.status === 200) {
                    window.location.href = `/descargar_reporte/${filename}`;
                } else {
                    setTimeout(checkIfReady, 3000); // intenta de nuevo en 3s
                }
            });
    }

    setTimeout(checkIfReady, 3000);
</script>

{% endblock %}